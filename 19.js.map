{"version":3,"file":"19.js","sources":["webpack:///./src/views/result/tree.vue?577e","webpack:///./src/views/result/tree.vue?392a","webpack:///./node_modules/vue-json-pretty/lib/styles.css","webpack:///./node_modules/vue-json-pretty/lib/styles.css?d1d1","webpack:///./src/api/results.js","webpack:///./src/views/result/tree.vue","webpack:///./src/views/result/tree.vue?f4a8","webpack:///./src/views/result/tree.vue?eb1f"],"sourcesContent":["import _defineProperty from \"/home/runner/work/opentmi-default-gui/opentmi-default-gui/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.regexp.match\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport VJstree from 'vue-jstree';\nimport VueJsonPretty from 'vue-json-pretty';\nimport 'vue-json-pretty/lib/styles.css';\nimport { resultsList, searchResult } from '@/api/results';\nexport default {\n  name: 'ResultTree',\n  components: {\n    VJstree: VJstree,\n    VueJsonPretty: VueJsonPretty\n  },\n  filters: {\n    commitId: function commitId(row, _) {\n      var commitId = _.get(row, 'exec.sut.commitId', '');\n\n      if (!commitId) return '';\n      return \"SUT commit: \".concat(commitId);\n    },\n    commitUrl: function commitUrl(row, _) {\n      console.log('commitUrl: ', row, _);\n\n      var commitId = _.get(row, 'exec.sut.commitId', '');\n\n      var url = _.get(row, 'exec.sut.gitUrl', '');\n\n      var match = url.match(/((git|ssh|http(s)?)|(git@[\\w.]+))(:(\\/\\/)?)([\\w.@:/\\-~]+)(\\.git)(\\/)?/);\n\n      if (match) {\n        var group7 = match[7];\n\n        if (group7.startsWith('github.com')) {\n          url = \"https://\".concat(group7, \"/commit/\").concat(commitId);\n        }\n      }\n\n      return url;\n    }\n  },\n  data: function data() {\n    return {\n      row: {},\n      treeData: [],\n      loadData: this._.debounce(this._loadData, 250)\n    };\n  },\n  methods: {\n    customLinkFormatter: function customLinkFormatter(data, key, path, defaultFormatted) {\n      if (typeof data === 'string' && data.startsWith('https://')) {\n        return \"<a style=\\\"color:red;\\\" href=\\\"\".concat(data, \"\\\" target=\\\"_blank\\\">\\\"\").concat(data, \"\\\"</a>\");\n      }\n\n      return defaultFormatted;\n    },\n    _loadData: function _loadData(node, resolve) {\n      var id = node.data.id ? node.data.id : 0;\n      var _node$data = node.data,\n          level = _node$data.level,\n          type = _node$data.type,\n          _node$data$filters = _node$data.filters,\n          filters = _node$data$filters === void 0 ? {} : _node$data$filters;\n      var options = {\n        level: level + 1,\n        field: NaN,\n        type: type,\n        filters: filters\n      };\n\n      if (id === 0) {\n        return this.getRoot().then(resolve);\n      }\n\n      if (type === 'tests') {\n        if (level === 0) {\n          options.field = 'tcid';\n        } else if (level === 1) {\n          options.field = 'campaign';\n        } else if (level === 2) {\n          options.field = 'job.id';\n        } else if (level === 3) {\n          options.field = 'exec.duts.0.model';\n        } else if (level === 4) {\n          options.field = 'exec.verdict';\n        } else if (level === 5) {\n          options.icon = 'el-icon-tickets';\n          options.isLeaf = true;\n          options.field = '_id';\n        }\n      } else if (type === 'campaigns') {\n        if (level === 0) {\n          options.field = 'campaign';\n        } else if (level === 1) {\n          options.field = 'job.id';\n        } else if (level === 2) {\n          options.field = 'tcid';\n        } else if (level === 3) {\n          options.field = 'exec.verdict';\n        } else if (level === 4) {\n          options.isLeaf = true;\n          options.field = '_id';\n          options.icon = 'el-icon-tickets';\n        }\n      } else if (type === 'dutModels') {\n        if (level === 0) {\n          options.field = 'exec.duts.0.model';\n        } else if (level === 1) {\n          options.field = 'campaign';\n        } else if (level === 2) {\n          options.field = 'job.id';\n        } else if (level === 3) {\n          options.field = 'tcid';\n        } else if (level === 4) {\n          options.field = 'exec.verdict';\n        } else if (level === 5) {\n          options.isLeaf = true;\n          options.field = '_id';\n          options.icon = 'el-icon-tickets';\n        }\n      } else {\n        console.log('unknown type');\n      }\n\n      return this.getDistinct(options).then(resolve);\n    },\n    distinct: function distinct(filters, field) {\n      var query = {\n        t: 'distinct',\n        f: field,\n        l: 1000,\n        s: {\n          'cre.time': 1\n        },\n        'cre.time': \"{gt}\".concat(this.lastMonthDate().toISOString()),\n        to: 5000\n      };\n      return this._.merge(query, filters);\n    },\n    getRoot: function getRoot() {\n      return Promise.resolve([{\n        text: 'by tests',\n        level: 0,\n        type: 'tests',\n        isLeaf: false\n      }, {\n        text: 'by campaigns',\n        level: 0,\n        type: 'campaigns',\n        isLeaf: false\n      }, {\n        text: 'by dut models',\n        level: 0,\n        type: 'dutModels',\n        isLeaf: false\n      }]);\n    },\n    getDistinct: function getDistinct(_ref) {\n      var _this = this;\n\n      var level = _ref.level,\n          field = _ref.field,\n          _ref$filters = _ref.filters,\n          filters = _ref$filters === void 0 ? {} : _ref$filters,\n          type = _ref.type,\n          _ref$isLeaf = _ref.isLeaf,\n          isLeaf = _ref$isLeaf === void 0 ? false : _ref$isLeaf,\n          icon = _ref.icon;\n      var query = this.distinct(filters, field);\n      return resultsList(query).then(function (_ref2) {\n        var data = _ref2.data;\n        console.log('results: ', {\n          query: query,\n          data: data\n        });\n\n        var mapper = function mapper(text) {\n          var _filters = _this._.clone(filters);\n\n          _this._.merge(_filters, _defineProperty({}, field, text));\n\n          return {\n            text: text,\n            level: level,\n            isLeaf: isLeaf,\n            icon: icon,\n            type: type,\n            filters: _filters\n          };\n        };\n\n        var treeData = _this._.map(data, mapper);\n\n        console.log({\n          treeData: treeData\n        });\n        return treeData;\n      });\n    },\n    lastMonthDate: function lastMonthDate() {\n      var ourDate = new Date(); // Change it so that it is 30 days in the past.\n\n      var pastDate = ourDate.getDate() - 30;\n      ourDate.setDate(pastDate);\n      return ourDate;\n    },\n    itemClick: function itemClick(node, item, e) {\n      var _this2 = this;\n\n      var filters = this._.cloneDeep(node.model.filters);\n\n      if (node.model.isLeaf) {\n        var _id = node.model.filters._id;\n        console.log('Get result: ', _id);\n        searchResult(_id).then(function (_ref3) {\n          var data = _ref3.data;\n          // eslint-disable-next-line no-console\n          console.log(\"searchResult(\".concat(_id, \"): \").concat(data));\n          _this2.row = data;\n        });\n      } else {\n        this.row = filters;\n      }\n    }\n  }\n};","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"app-container\" },\n    [\n      _c(\n        \"el-row\",\n        [\n          _c(\n            \"el-col\",\n            { attrs: { span: 12 } },\n            [\n              _c(\"v-jstree\", {\n                attrs: { data: _vm.treeData, async: _vm.loadData },\n                on: { \"item-click\": _vm.itemClick }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"el-col\",\n            { attrs: { span: 12 } },\n            [\n              _c(\n                \"a\",\n                { attrs: { href: _vm._f(\"commitUrl\")(_vm.row, this._) } },\n                [_vm._v(_vm._s(_vm._f(\"commitId\")(_vm.row, this._)))]\n              ),\n              _c(\"br\"),\n              _vm._v(\" \"),\n              _c(\"vue-json-pretty\", {\n                attrs: {\n                  data: _vm.row,\n                  deep: 1,\n                  \"deep-collapse-children\": true,\n                  \"show-length\": true,\n                  \"show-double-quotes\": false,\n                  \"custom-value-formatter\": _vm.customLinkFormatter\n                }\n              })\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","exports = module.exports = require(\"../../css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".vjs-tree__brackets{cursor:pointer}.vjs-tree__brackets:hover{color:#1890ff}.vjs-check-controller{position:absolute;left:0}.vjs-check-controller.is-checked .vjs-check-controller__inner{background-color:#1890ff;border-color:#0076e4}.vjs-check-controller.is-checked .vjs-check-controller__inner.is-checkbox:after{-webkit-transform:rotate(45deg) scaleY(1);transform:rotate(45deg) scaleY(1)}.vjs-check-controller.is-checked .vjs-check-controller__inner.is-radio:after{-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}.vjs-check-controller .vjs-check-controller__inner{display:inline-block;position:relative;border:1px solid #bfcbd9;border-radius:2px;vertical-align:middle;-webkit-box-sizing:border-box;box-sizing:border-box;width:16px;height:16px;background-color:#fff;z-index:1;cursor:pointer;-webkit-transition:border-color .25s cubic-bezier(.71,-.46,.29,1.46),background-color .25s cubic-bezier(.71,-.46,.29,1.46);-o-transition:border-color .25s cubic-bezier(.71,-.46,.29,1.46),background-color .25s cubic-bezier(.71,-.46,.29,1.46);transition:border-color .25s cubic-bezier(.71,-.46,.29,1.46),background-color .25s cubic-bezier(.71,-.46,.29,1.46)}.vjs-check-controller .vjs-check-controller__inner:after{-webkit-box-sizing:content-box;box-sizing:content-box;content:\\\"\\\";border:2px solid #fff;border-left:0;border-top:0;height:8px;left:4px;position:absolute;top:1px;-webkit-transform:rotate(45deg) scaleY(0);transform:rotate(45deg) scaleY(0);width:4px;-webkit-transition:-webkit-transform .15s cubic-bezier(.71,-.46,.88,.6) .05s;transition:-webkit-transform .15s cubic-bezier(.71,-.46,.88,.6) .05s;-o-transition:transform .15s cubic-bezier(.71,-.46,.88,.6) .05s;transition:transform .15s cubic-bezier(.71,-.46,.88,.6) .05s;transition:transform .15s cubic-bezier(.71,-.46,.88,.6) .05s, -webkit-transform .15s cubic-bezier(.71,-.46,.88,.6) .05s;-webkit-transform-origin:center;transform-origin:center}.vjs-check-controller .vjs-check-controller__inner.is-radio{border-radius:100%}.vjs-check-controller .vjs-check-controller__inner.is-radio:after{border-radius:100%;height:4px;background-color:#fff;left:50%;top:50%}.vjs-check-controller .vjs-check-controller__original{opacity:0;outline:none;position:absolute;z-index:-1;top:0;left:0;right:0;bottom:0;margin:0}.vjs-tree__node{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative}.vjs-tree__node.has-selector{padding-left:30px}.vjs-tree__node.is-highlight,.vjs-tree__node:hover{background-color:#e6f7ff}.vjs-tree__node .vjs-tree__indent{-webkit-box-flex:0;-webkit-flex:0 0 1em;-ms-flex:0 0 1em;flex:0 0 1em}.vjs-tree__node .vjs-tree__indent.has-line{border-left:1px dashed #bfcbd9}.vjs-comment{color:#bfcbd9}.vjs-value__null{color:#ff4949}.vjs-value__boolean,.vjs-value__number{color:#1d8ce0}.vjs-value__string{color:#13ce66}.vjs-tree{font-family:Monaco,Menlo,Consolas,Bitstream Vera Sans Mono,monospace;font-size:14px}.vjs-tree.is-virtual{overflow:auto}.vjs-tree.is-virtual .vjs-tree__node{white-space:nowrap}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../css-loader/index.js??ref--6-oneOf-3-1!../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./styles.css\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"91fdbc0a\", content, false, {\"sourceMap\":false,\"shadowMode\":false});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../css-loader/index.js??ref--6-oneOf-3-1!../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./styles.css\", function() {\n     var newContent = require(\"!!../../css-loader/index.js??ref--6-oneOf-3-1!../../postcss-loader/src/index.js??ref--6-oneOf-3-2!./styles.css\");\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport request from '@/utils/request';\nexport function searchResult(id) {\n  return request({\n    url: \"/api/v0/results/\".concat(id),\n    method: 'get'\n  });\n}\nexport function getSchema(_) {\n  return request({\n    url: \"/api/v0/schemas/Result.json\",\n    method: 'get'\n  }).then(function (_ref) {\n    var data = _ref.data;\n    var schema = data.schema;\n\n    var fill = function fill(key, _ref2) {\n      var title = _ref2.title,\n          _ref2$def = _ref2.def,\n          def = _ref2$def === void 0 ? '' : _ref2$def;\n      key = key.split('.').join('.properties.');\n\n      _.set(schema, \"properties.\".concat(key, \".title\"), title);\n\n      _.set(schema, \"properties.\".concat(key, \".default\"), def);\n    };\n\n    var drop = function drop(key) {\n      key = key.split('.').join('.properties.');\n\n      _.unset(schema, \"properties.\".concat(key));\n    };\n\n    var dropKeys = function dropKeys(keys) {\n      keys.forEach(drop);\n    };\n\n    fill('tcid', {\n      title: 'Testcase ID'\n    });\n    fill('campaign', {\n      title: 'Campaign'\n    });\n    fill('job.id', {\n      title: 'Job ID'\n    });\n    fill('exec.duration', {\n      title: 'Duration'\n    });\n    fill('exec.verdict', {\n      title: 'Verdict'\n    });\n    fill('exec.env.framework.name', {\n      title: 'Framework name'\n    });\n    fill('exec.env.framework.ver', {\n      title: 'Framework Version'\n    });\n    fill('exec.env.rackId', {\n      title: 'Rack ID'\n    });\n    fill('exec.note', {\n      title: 'Note'\n    });\n    fill('exec.sut.gitUrl', {\n      title: 'git uri'\n    });\n    fill('exec.sut.buildName', {\n      title: 'build name'\n    });\n    fill('exec.sut.buildDate', {\n      title: 'build date'\n    });\n    fill('exec.sut.branch', {\n      title: 'branch'\n    });\n    dropKeys(['exec.env.ref', 'exec.sut.ref', 'tcRef', '_id', 'campaignRef', 'cre', 'exec.dut']);\n    return schema;\n  });\n}\nexport function resultsList(query) {\n  return request({\n    url: '/api/v0/results',\n    method: 'get',\n    params: query,\n    timeout: query.to + 1000\n  });\n}","import { render, staticRenderFns } from \"./tree.vue?vue&type=template&id=20563e26&\"\nimport script from \"./tree.vue?vue&type=script&lang=js&\"\nexport * from \"./tree.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/runner/work/opentmi-default-gui/opentmi-default-gui/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('20563e26')) {\n      api.createRecord('20563e26', component.options)\n    } else {\n      api.reload('20563e26', component.options)\n    }\n    module.hot.accept(\"./tree.vue?vue&type=template&id=20563e26&\", function () {\n      api.rerender('20563e26', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/result/tree.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tree.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/cache-loader/dist/cjs.js?{\\\"cacheDirectory\\\":\\\"node_modules/.cache/vue-loader\\\",\\\"cacheIdentifier\\\":\\\"fc6c80c8-vue-loader-template\\\"}!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./tree.vue?vue&type=template&id=20563e26&\""],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpPA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}